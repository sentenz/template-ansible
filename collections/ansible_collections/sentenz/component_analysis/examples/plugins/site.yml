---
- name: Handle SBOM for Dependency-Track
  hosts: localhost
  gather_facts: false

  tasks:
    # ansible-playbook -i inventory.ini site.yml -e "base_url=http://3.64.246.3 api_key=<API_KEY> sbom_file_path=sbom.cdx.json project_name=DataParser project_version=2.8.3"
    - name: Create SBOM
      sentenz.component_analysis.sbom_create:
        base_url: "{{ base_url }}"
        api_key: "{{ api_key }}"
        sbom_file_path: "{{ sbom_file_path }}"
        project_name: "{{ project_name }}"
        project_version: "{{ project_version }}"
        auto_create: true
      register: result

    # # ansible-playbook -i inventory.ini site.yml site.yml -e "base_url=http://3.64.246.3 api_key=<API_KEY> uuid=<UUID>"
    # - name: Delete a SBOM
    #   sentenz.component_analysis.sbom_delete:
    #     base_url: "{{ base_url }}"
    #     api_key: "{{ api_key }}"
    #     uuid: "{{ uuid }}"
    #   register: result

    # # ansible-playbook -i inventory.ini site.yml site.yml -e "base_url=http://3.64.246.3 api_key=<API_KEY> uuid=<UUID>"
    # - name: Read a SBOM
    #   sentenz.component_analysis.sbom_read:
    #     base_url: "{{ base_url }}"
    #     api_key: "{{ api_key }}"
    #     uuid: "{{ uuid }}"
    #   register: result

    - name: Debug output
      ansible.builtin.debug:
        var: result.message
