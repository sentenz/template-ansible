---
- name: Handle BOM for Dependency-Track
  hosts: localhost
  gather_facts: false

  tasks:
    # ansible-playbook -i inventory.ini site.yml -e "base_url=http://3.64.246.3 api_key=<api_key> sbom_file_path=sbom.cdx.json project_name=DataParser project_version=2.8.3"
    - name: Create BOM
      sentenz.dependency_track.bom_create:
        base_url: "{{ base_url }}"
        api_key: "{{ api_key }}"
        sbom_file_path: "{{ sbom_file_path }}"
        project_name: "{{ project_name }}"
        project_version: "{{ project_version }}"
        auto_create: true
      register: result

    # # ansible-playbook -i inventory.ini site.yml site.yml -e "base_url=http://3.64.246.3 api_key=<api_key> uuid=36f5b85c-0015-43c3-a0ad-489c4138e610"
    # - name: Delete a BOM
    #   sentenz.dependency_track.bom_delete:
    #     base_url: "{{ base_url }}"
    #     api_key: "{{ api_key }}"
    #     uuid: "{{ uuid }}"
    #   register: result

    # # ansible-playbook -i inventory.ini site.yml site.yml -e "base_url=http://3.64.246.3 api_key=<api_key> uuid=36f5b85c-0015-43c3-a0ad-489c4138e610"
    # - name: Read a BOM
    #   sentenz.dependency_track.bom_read:
    #     base_url: "{{ base_url }}"
    #     api_key: "{{ api_key }}"
    #     uuid: "{{ uuid }}"
    #   register: result

    - name: Debug output
      ansible.builtin.debug:
        var: result.message
